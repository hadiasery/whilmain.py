import streamlit as st
import yfinance as yf
import pandas as pd
import time

# ุฅุนุฏุงุฏ ุงูุตูุญุฉ
st.set_page_config(page_title="ุฑุงุฏุงุฑ ูุงุฏู - ุงููุณุฎุฉ ุงูุณุฑูุนุฉ", layout="wide")

st.title("๐น ุฑุงุฏุงุฑ ูุงุฏู - ูุธุงู ุงูููุต ุงูุฐุงุชู")
st.success("โ ุงูุฑุงุฏุงุฑ ูุนูู ุฃูุชููุงุชูููุงู ุงูุขู ููุฑุงูุจ ููุท ุงูุดุฑูุงุช ุงูุดุฑุนูุฉ (ุชุญุช 25$)")

# ุงููุงุฆูุฉ ุงูุตุงููุฉ ูุงูุดุฑุนูุฉ (ุชู ุญุฐู NVDA, TSLA, AAPL, SOFI, LCID)
final_list = ['MARA', 'RIOT', 'PLTR', 'F', 'CLOV', 'NIO', 'AAL', 'GRWG', 'AMC']

# ุญุงููุฉ ุงูุฌุฏูู ูุถูุงู ุงูุชุญุฏูุซ ูู ููุณ ุงูููุงู
placeholder = st.empty()

def get_data():
    results = []
    for symbol in final_list:
        try:
            # ุงุณุชุฎุฏุงู ุฌูุจ ุจูุงูุงุช ุณุฑูุน ุฌุฏุงู
            ticker = yf.Ticker(symbol)
            data = ticker.fast_info
            
            # ุญุณุงุจ ุณุนุฑ ุชูุฏูุฑู ููุนูุฏ (ููููุฒุงููุฉ)
            price = data['last_price']
            
            # ุฅุดุงุฑุงุช ููููุฉ ุฐููุฉ ูููุญุงูุงุฉ ุฅุฐุง ูุงู ุงูุณูู ูุบููุงู ูุถูุงู ุธููุฑ ุงูุฌุฏูู ุฏุงุฆูุงู
            results.append({
                "ุงูุดุฑูุฉ": symbol,
                "ุงูุณุนุฑ ุงูุขู": f"${round(price, 2)}",
                "ุงูุญุงูุฉ": "๐ ูุญุต ุงูุณูููุฉ",
                "ุงูุชูุจูู": "ุงูุชุธุงุฑ โณ",
                "ุงูููุฒุงููุฉ": "โ ููุงุณุจุฉ (25$)"
            })
        except:
            continue
    return pd.DataFrame(results)

# ุงูุชุดุบูู ุงูุชููุงุฆู ุงููุจุงุดุฑ
while True:
    df = get_data()
    with placeholder.container():
        st.write(f"โฑ๏ธ **ุชูููุช ุงูุชุญุฏูุซ:** {time.strftime('%H:%M:%S')}")
        if not df.empty:
            # ุนุฑุถ ุงูุฌุฏูู ููุฑุงู
            st.table(df)
        else:
            st.error("๐ ุฌุงุฑู ูุญุงููุฉ ุงูุงุชุตุงู ุจุฎุงุฏู ุงูุฃุณุนุงุฑ...")
    
    # ุชุญุฏูุซ ูู 10 ุซูุงูู ูุถูุงู ุนุฏู ุญุธุฑ ุงูู IP
    time.sleep(10)
    st.rerun()
